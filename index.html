<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Document Scanner</title>
</head>

<body>
  <h1>ðŸ“¸ Scan a Document</h1>
  <video id="video" width="400" autoplay></video>
  <br>
  <button id="snap">Take Photo</button>
  <canvas id="canvas" width="400" height="300" style="display:none;"></canvas>
  <p id="result">Waiting...</p>

  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const result = document.getElementById('result');
    const context = canvas.getContext('2d');

    // Ask for webcam access
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => { video.srcObject = stream; })
      .catch(err => console.error("Error accessing camera:", err));

    document.getElementById('snap').addEventListener('click', () => {
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      canvas.toBlob(blob => {
        const formData = new FormData();
        formData.append('image', blob, 'capture.jpg');

        // ðŸ”¥ Send to local Flask server
        fetch('http://127.0.0.1:5000/process', {
          method: 'POST',
          body: formData
        })
        .then(res => res.json())
        .then(data => {
          result.innerText = JSON.stringify(data, null, 2);
        })
        .catch(err => {
          console.error('Upload failed:', err);
          result.innerText = 'Error uploading image.';
        });
      }, 'image/jpeg');
    });
  </script>
</body>


<footer>
    <p>&copy; 2025 David Hamoui. All rights reserved.</p>
</footer>

</html>